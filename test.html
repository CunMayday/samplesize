<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A/B Testing Dashboard - Statistical Learning Tool</title>
    
    <!-- Tailwind CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    
    <!-- Chart.js for charts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    
    <style>
        :root {
            /* Official Purdue Colors */
            --purdue-campus-gold: #C28E0E;
            --purdue-athletic-gold: #CEB888;
            --purdue-black: #000000;
            --purdue-gray: #9D968D;
            --purdue-dark-gray: #373A36;
            --purdue-white: #FFFFFF;
            
            /* Light variations for backgrounds */
            --purdue-gold-light: #F5F1E8;
            --purdue-gold-lighter: #FAF8F2;
            --purdue-gray-light: #F5F4F3;
        }
        
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
                'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
                sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            background-color: var(--purdue-gray-light);
        }
        
        /* Custom Purdue-themed classes */
        .bg-purdue-gold { background-color: var(--purdue-campus-gold); }
        .bg-purdue-gold-light { background-color: var(--purdue-gold-light); }
        .bg-purdue-gold-lighter { background-color: var(--purdue-gold-lighter); }
        .bg-purdue-black { background-color: var(--purdue-black); }
        .bg-purdue-gray { background-color: var(--purdue-gray); }
        .bg-purdue-gray-light { background-color: var(--purdue-gray-light); }
        
        .text-purdue-gold { color: var(--purdue-campus-gold); }
        .text-purdue-black { color: var(--purdue-black); }
        .text-purdue-gray { color: var(--purdue-gray); }
        .text-purdue-dark-gray { color: var(--purdue-dark-gray); }
        
        .border-purdue-gold { border-color: var(--purdue-campus-gold); }
        .border-purdue-black { border-color: var(--purdue-black); }
        .border-purdue-gray { border-color: var(--purdue-gray); }
        
        .ring-purdue-gold { --tw-ring-color: var(--purdue-campus-gold); }
        .ring-purdue-black { --tw-ring-color: var(--purdue-black); }
        
        /* Success/Error states using Purdue colors */
        .bg-purdue-success { background-color: var(--purdue-gold-light); border-color: var(--purdue-campus-gold); }
        .bg-purdue-warning { background-color: var(--purdue-gold-lighter); border-color: var(--purdue-athletic-gold); }
        .bg-purdue-error { background-color: var(--purdue-gray-light); border-color: var(--purdue-gray); }
    </style>
</head>
<body>
    <div id="root">
        <div class="p-6 max-w-7xl mx-auto min-h-screen">
            <!-- Header -->
            <div class="bg-white rounded-lg shadow-lg p-6 mb-6 border-t-4 border-purdue-gold">
                <h1 class="text-3xl font-bold text-purdue-black mb-2">A/B Testing Dashboard</h1>
                <p class="text-purdue-dark-gray">Interactive statistical learning tool for hypothesis testing</p>
                <div class="mt-3 text-sm text-purdue-gray">Powered by Purdue University Statistical Methods</div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- LEFT COLUMN - INPUTS -->
                <div class="space-y-6">
                    <!-- Test Configuration -->
                    <div class="bg-white rounded-lg shadow-lg p-6 border-l-4 border-purdue-gold">
                        <h2 class="text-xl font-semibold mb-4 text-purdue-black">Test Configuration</h2>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-purdue-dark-gray mb-2">Test Scenario</label>
                                <select id="scenario" class="w-full p-3 border border-purdue-gray rounded-md focus:ring-2 ring-purdue-gold focus:border-purdue-gold">
                                    <option value="website">Website Conversion Rate Test</option>
                                    <option value="email">Email Marketing Campaign Test</option>
                                    <option value="app">Mobile App Feature Test</option>
                                </select>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-purdue-dark-gray mb-2">Significance Level (Î±)</label>
                                <select id="significance" class="w-full p-3 border border-purdue-gray rounded-md focus:ring-2 ring-purdue-gold focus:border-purdue-gold">
                                    <option value="0.10">0.10 (10%)</option>
                                    <option value="0.05" selected>0.05 (5%)</option>
                                    <option value="0.01">0.01 (1%)</option>
                                </select>
                            </div>

                            <div id="scenario-description" class="bg-purdue-gold-light p-4 rounded-lg border border-purdue-gold">
                                <h3 class="font-semibold text-purdue-black">Website Conversion Rate Test</h3>
                                <p class="text-purdue-dark-gray text-sm">Testing if a new website design improves conversion rates</p>
                            </div>
                        </div>
                    </div>

                    <!-- Group A Inputs -->
                    <div class="bg-white rounded-lg shadow-lg p-6 border-l-4 border-purdue-black">
                        <h2 class="text-xl font-semibold mb-4 text-purdue-black">Group A: <span id="groupALabel">Original Design</span></h2>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-purdue-dark-gray mb-2">Sample Size</label>
                                <input type="number" id="groupASize" value="1000" min="50" max="10000" 
                                       class="w-full p-3 border border-purdue-gray rounded-md focus:ring-2 ring-purdue-black focus:border-purdue-black">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-purdue-dark-gray mb-2"><span id="metricA">Conversion Rate</span> (%)</label>
                                <input type="number" id="groupARate" value="12.0" min="0" max="100" step="0.1"
                                       class="w-full p-3 border border-purdue-gray rounded-md focus:ring-2 ring-purdue-black focus:border-purdue-black">
                            </div>
                            <div class="bg-purdue-gray-light p-3 rounded border border-purdue-gray">
                                <p class="text-sm text-purdue-dark-gray">
                                    <strong>Conversions:</strong> <span id="groupAConversions">120</span> out of <span id="groupASizeDisplay">1000</span>
                                </p>
                                <p class="text-sm text-purdue-dark-gray">
                                    <strong>Rate:</strong> <span id="groupARateDisplay">12.00%</span>
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Group B Inputs -->
                    <div class="bg-white rounded-lg shadow-lg p-6 border-l-4 border-purdue-gold">
                        <h2 class="text-xl font-semibold mb-4 text-purdue-gold">Group B: <span id="groupBLabel">New Design</span></h2>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-purdue-dark-gray mb-2">Sample Size</label>
                                <input type="number" id="groupBSize" value="1000" min="50" max="10000"
                                       class="w-full p-3 border border-purdue-gray rounded-md focus:ring-2 ring-purdue-gold focus:border-purdue-gold">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-purdue-dark-gray mb-2"><span id="metricB">Conversion Rate</span> (%)</label>
                                <input type="number" id="groupBRate" value="15.0" min="0" max="100" step="0.1"
                                       class="w-full p-3 border border-purdue-gray rounded-md focus:ring-2 ring-purdue-gold focus:border-purdue-gold">
                            </div>
                            <div class="bg-purdue-gold-light p-3 rounded border border-purdue-gold">
                                <p class="text-sm text-purdue-dark-gray">
                                    <strong>Conversions:</strong> <span id="groupBConversions">150</span> out of <span id="groupBSizeDisplay">1000</span>
                                </p>
                                <p class="text-sm text-purdue-dark-gray">
                                    <strong>Rate:</strong> <span id="groupBRateDisplay">15.00%</span>
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Learning Notes -->
                    <div class="bg-white rounded-lg shadow-lg p-6 border border-purdue-gray">
                        <h2 class="text-xl font-semibold mb-4 text-purdue-black">Learning Notes</h2>
                        <div class="space-y-3 text-sm text-purdue-dark-gray">
                            <p><strong class="text-purdue-black">P-Value:</strong> The probability of observing this difference (or more extreme) if there's truly no difference between groups.</p>
                            <p><strong class="text-purdue-black">Z-Statistic:</strong> Measures how many standard errors the observed difference is from zero.</p>
                            <p><strong class="text-purdue-black">Effect Size:</strong> The actual difference between groups, regardless of statistical significance.</p>
                            <p><strong class="text-purdue-black">Statistical Power:</strong> The probability of detecting a true difference when it exists.</p>
                        </div>
                    </div>
                </div>

                <!-- RIGHT COLUMN - RESULTS -->
                <div class="space-y-6">
                    <!-- Visualization -->
                    <div class="bg-white rounded-lg shadow-lg p-6 border-t-4 border-purdue-gold">
                        <h2 class="text-xl font-semibold mb-4 text-purdue-black">Visualization</h2>
                        <div class="h-64">
                            <canvas id="chartCanvas"></canvas>
                        </div>
                    </div>

                    <!-- Test Results -->
                    <div class="bg-white rounded-lg shadow-lg p-6 border-t-4 border-purdue-black">
                        <h2 class="text-xl font-semibold mb-4 text-purdue-black">Test Results</h2>
                        
                        <div id="interpretation" class="p-4 rounded-lg mb-6 bg-purdue-success border">
                            <p class="font-medium text-lg text-purdue-black">ð Statistically Significant! The difference of 3.00% is unlikely due to chance alone (p = 0.0159). We can reject the null hypothesis.</p>
                        </div>

                        <div class="grid grid-cols-2 gap-4 mb-6">
                            <div class="bg-purdue-gray-light p-4 rounded-lg text-center border border-purdue-gray">
                                <h3 class="font-semibold text-purdue-dark-gray mb-1">Z-Statistic</h3>
                                <p id="zStat" class="text-3xl font-bold text-purdue-black">2.404</p>
                            </div>
                            
                            <div id="pValueBox" class="p-4 rounded-lg text-center bg-purdue-warning border">
                                <h3 class="font-semibold mb-1 text-purdue-black">P-Value</h3>
                                <p id="pValue" class="text-3xl font-bold text-purdue-black">0.0163</p>
                            </div>
                            
                            <div class="bg-purdue-gray-light p-4 rounded-lg text-center border border-purdue-gray">
                                <h3 class="font-semibold text-purdue-dark-gray mb-1">Effect Size</h3>
                                <p id="effectSize" class="text-3xl font-bold text-purdue-gold">3.00%</p>
                            </div>
                            
                            <div class="bg-purdue-gray-light p-4 rounded-lg text-center border border-purdue-gray">
                                <h3 class="font-semibold text-purdue-dark-gray mb-1">Statistical Power</h3>
                                <p id="power" class="text-3xl font-bold text-purdue-gold">75.2%</p>
                            </div>
                        </div>
                    </div>

                    <!-- Statistical Details -->
                    <div class="bg-white rounded-lg shadow-lg p-6 border border-purdue-gray">
                        <h2 class="text-xl font-semibold mb-4 text-purdue-black">Statistical Details</h2>
                        
                        <div class="space-y-4">
                            <div class="bg-purdue-gold-light p-4 rounded-lg border border-purdue-gold">
                                <h3 class="font-semibold text-purdue-black mb-2">Hypothesis Test Setup</h3>
                                <p class="text-purdue-dark-gray text-sm"><strong>Hâ:</strong> pâ = pâ (No difference between groups)</p>
                                <p class="text-purdue-dark-gray text-sm"><strong>Hâ:</strong> pâ â  pâ (There is a difference between groups)</p>
                                <p class="text-purdue-dark-gray text-sm"><strong>Significance Level:</strong> Î± = <span id="alphaDisplay">0.05</span></p>
                            </div>
                            
                            <div class="bg-purdue-gray-light p-4 rounded-lg border border-purdue-gray">
                                <h3 class="font-semibold text-purdue-black mb-2">Confidence Interval (95%)</h3>
                                <p class="text-purdue-dark-gray text-sm">
                                    The true difference is likely between <strong class="text-purdue-black"><span id="ciLower">0.55%</span></strong> and <strong class="text-purdue-black"><span id="ciUpper">5.45%</span></strong>
                                </p>
                                <p id="ciWarning" class="text-purdue-gold mt-1 text-sm font-semibold" style="display: none;">â ï¸ The confidence interval includes 0, suggesting no significant difference.</p>
                            </div>

                            <div class="bg-purdue-gold-lighter p-4 rounded-lg border border-purdue-gold">
                                <h3 class="font-semibold text-purdue-black mb-2">Key Metrics</h3>
                                <div class="grid grid-cols-2 gap-2 text-sm">
                                    <p class="text-purdue-dark-gray"><strong class="text-purdue-black">Pooled Proportion:</strong> <span id="pooledProp">13.50%</span></p>
                                    <p class="text-purdue-dark-gray"><strong class="text-purdue-black">Standard Error:</strong> <span id="standardError">0.0125</span></p>
                                    <p class="text-purdue-dark-gray"><strong class="text-purdue-black">Group A Rate:</strong> <span id="groupAFinal">12.00%</span></p>
                                    <p class="text-purdue-dark-gray"><strong class="text-purdue-black">Group B Rate:</strong> <span id="groupBFinal">15.00%</span></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Purdue color palette
        const purdueColors = {
            campusGold: '#C28E0E',
            athleticGold: '#CEB888',
            black: '#000000',
            gray: '#9D968D',
            darkGray: '#373A36',
            white: '#FFFFFF'
        };

        // Scenario configurations
        const scenarios = {
            website: {
                title: "Website Conversion Rate Test",
                description: "Testing if a new website design improves conversion rates",
                metric: "Conversion Rate",
                groupALabel: "Original Design",
                groupBLabel: "New Design"
            },
            email: {
                title: "Email Marketing Campaign Test",
                description: "Testing if a new email subject line improves open rates",
                metric: "Open Rate",
                groupALabel: "Current Subject",
                groupBLabel: "New Subject"
            },
            app: {
                title: "Mobile App Feature Test",
                description: "Testing if a new button color increases click-through rates",
                metric: "Click-through Rate",
                groupALabel: "Blue Button",
                groupBLabel: "Red Button"
            }
        };

        let chart = null;

        // Statistical functions
        function normalCDF(x) {
            return 0.5 * (1 + erf(x / Math.sqrt(2)));
        }

        function erf(x) {
            const a1 = 0.254829592;
            const a2 = -0.284496736;
            const a3 = 1.421413741;
            const a4 = -1.453152027;
            const a5 = 1.061405429;
            const p = 0.3275911;
            
            const sign = x >= 0 ? 1 : -1;
            x = Math.abs(x);
            
            const t = 1.0 / (1.0 + p * x);
            const y = 1.0 - (((((a5 * t + a4) * t) + a3) * t + a2) * t + a1) * t * Math.exp(-x * x);
            
            return sign * y;
        }

        function calculatePower(n1, n2, p1, p2, alpha) {
            const pooledP = (n1 * p1 + n2 * p2) / (n1 + n2);
            const se1 = Math.sqrt(pooledP * (1 - pooledP) * (1/n1 + 1/n2));
            const se2 = Math.sqrt(p1 * (1 - p1) / n1 + p2 * (1 - p2) / n2);
            const criticalValue = 1.96;
            const effectSize = Math.abs(p2 - p1);
            const zBeta = (effectSize - criticalValue * se1) / se2;
            return normalCDF(zBeta);
        }

        function calculateResults() {
            const groupASize = parseInt(document.getElementById('groupASize').value) || 0;
            const groupBSize = parseInt(document.getElementById('groupBSize').value) || 0;
            const groupARate = parseFloat(document.getElementById('groupARate').value) / 100 || 0;
            const groupBRate = parseFloat(document.getElementById('groupBRate').value) / 100 || 0;
            const significanceLevel = parseFloat(document.getElementById('significance').value) || 0.05;

            const groupASuccesses = Math.round(groupASize * groupARate);
            const groupBSuccesses = Math.round(groupBSize * groupBRate);
            
            const p1 = groupASuccesses / groupASize;
            const p2 = groupBSuccesses / groupBSize;
            
            const pooledP = (groupASuccesses + groupBSuccesses) / (groupASize + groupBSize);
            const se = Math.sqrt(pooledP * (1 - pooledP) * (1/groupASize + 1/groupBSize));
            const zStat = (p2 - p1) / se;
            const pValue = 2 * (1 - normalCDF(Math.abs(zStat)));
            
            const effectSize = p2 - p1;
            const effectSizePercent = effectSize * 100;
            
            const seDiff = Math.sqrt((p1 * (1 - p1)) / groupASize + (p2 * (1 - p2)) / groupBSize);
            const criticalValue = 1.96;
            const ciLower = effectSize - criticalValue * seDiff;
            const ciUpper = effectSize + criticalValue * seDiff;
            
            const power = calculatePower(groupASize, groupBSize, p1, p2, significanceLevel);
            const isSignificant = pValue < significanceLevel;

            return {
                groupASuccesses,
                groupBSuccesses,
                p1,
                p2,
                zStat,
                pValue,
                effectSize,
                effectSizePercent,
                ciLower: ciLower * 100,
                ciUpper: ciUpper * 100,
                isSignificant,
                power,
                pooledP,
                se
            };
        }

        function updateDisplay() {
            const scenario = document.getElementById('scenario').value;
            const config = scenarios[scenario];
            
            // Update scenario labels
            document.getElementById('groupALabel').textContent = config.groupALabel;
            document.getElementById('groupBLabel').textContent = config.groupBLabel;
            document.getElementById('metricA').textContent = config.metric;
            document.getElementById('metricB').textContent = config.metric;
            
            document.querySelector('#scenario-description h3').textContent = config.title;
            document.querySelector('#scenario-description p').textContent = config.description;

            // Update conversion displays
            const groupASize = parseInt(document.getElementById('groupASize').value) || 0;
            const groupBSize = parseInt(document.getElementById('groupBSize').value) || 0;
            const groupARate = parseFloat(document.getElementById('groupARate').value) || 0;
            const groupBRate = parseFloat(document.getElementById('groupBRate').value) || 0;

            const groupAConversions = Math.round(groupASize * groupARate / 100);
            const groupBConversions = Math.round(groupBSize * groupBRate / 100);

            document.getElementById('groupAConversions').textContent = groupAConversions;
            document.getElementById('groupASizeDisplay').textContent = groupASize;
            document.getElementById('groupARateDisplay').textContent = groupARate.toFixed(2) + '%';

            document.getElementById('groupBConversions').textContent = groupBConversions;
            document.getElementById('groupBSizeDisplay').textContent = groupBSize;
            document.getElementById('groupBRateDisplay').textContent = groupBRate.toFixed(2) + '%';

            // Calculate and display results
            const results = calculateResults();
            
            document.getElementById('zStat').textContent = results.zStat.toFixed(3);
            document.getElementById('pValue').textContent = results.pValue.toFixed(4);
            document.getElementById('effectSize').textContent = results.effectSizePercent.toFixed(2) + '%';
            document.getElementById('power').textContent = (results.power * 100).toFixed(1) + '%';
            
            document.getElementById('alphaDisplay').textContent = document.getElementById('significance').value;
            document.getElementById('ciLower').textContent = results.ciLower.toFixed(2) + '%';
            document.getElementById('ciUpper').textContent = results.ciUpper.toFixed(2) + '%';
            document.getElementById('pooledProp').textContent = (results.pooledP * 100).toFixed(2) + '%';
            document.getElementById('standardError').textContent = results.se.toFixed(4);
            document.getElementById('groupAFinal').textContent = (results.p1 * 100).toFixed(2) + '%';
            document.getElementById('groupBFinal').textContent = (results.p2 * 100).toFixed(2) + '%';

            // Update interpretation
            const interpretation = results.isSignificant 
                ? `ð Statistically Significant! The difference of ${results.effectSizePercent.toFixed(2)}% is unlikely due to chance alone (p = ${results.pValue.toFixed(4)}). We can reject the null hypothesis.`
                : `â Not Statistically Significant. The observed difference of ${results.effectSizePercent.toFixed(2)}% could reasonably be due to chance (p = ${results.pValue.toFixed(4)}). We fail to reject the null hypothesis.`;
            
            document.getElementById('interpretation').innerHTML = `<p class="font-medium text-lg text-purdue-black">${interpretation}</p>`;
            
            const interpretationBox = document.getElementById('interpretation');
            interpretationBox.className = results.isSignificant 
                ? 'p-4 rounded-lg mb-6 bg-purdue-success border'
                : 'p-4 rounded-lg mb-6 bg-purdue-error border';

            // Update p-value color using Purdue colors
            const pValueBox = document.getElementById('pValueBox');
            if (results.pValue < 0.001) {
                pValueBox.className = 'p-4 rounded-lg text-center bg-purdue-success border';
            } else if (results.pValue < 0.01) {
                pValueBox.className = 'p-4 rounded-lg text-center bg-purdue-gold-light border border-purdue-gold';
            } else if (results.pValue < 0.05) {
                pValueBox.className = 'p-4 rounded-lg text-center bg-purdue-warning border';
            } else {
                pValueBox.className = 'p-4 rounded-lg text-center bg-purdue-error border';
            }

            // Show/hide CI warning
            const ciWarning = document.getElementById('ciWarning');
            if (results.ciLower <= 0 && results.ciUpper >= 0) {
                ciWarning.style.display = 'block';
            } else {
                ciWarning.style.display = 'none';
            }

            updateChart(config, groupARate, groupBRate);
        }

        function updateChart(config, groupARate, groupBRate) {
            const ctx = document.getElementById('chartCanvas');
            
            if (chart) {
                chart.destroy();
            }

            chart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: [config.groupALabel, config.groupBLabel],
                    datasets: [{
                        label: config.metric + ' (%)',
                        data: [groupARate, groupBRate],
                        backgroundColor: [purdueColors.black, purdueColors.campusGold],
                        borderColor: [purdueColors.darkGray, purdueColors.athleticGold],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: Math.max(groupARate, groupBRate) * 1.2,
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                },
                                color: purdueColors.darkGray
                            },
                            grid: {
                                color: purdueColors.gray
                            }
                        },
                        x: {
                            ticks: {
                                color: purdueColors.darkGray
                            },
                            grid: {
                                color: purdueColors.gray
                            }
                        }
                    }
                }
            });
        }

        // Event listeners
        document.getElementById('scenario').addEventListener('change', updateDisplay);
        document.getElementById('significance').addEventListener('change', updateDisplay);
        document.getElementById('groupASize').addEventListener('input', updateDisplay);
        document.getElementById('groupBSize').addEventListener('input', updateDisplay);
        document.getElementById('groupARate').addEventListener('input', updateDisplay);
        document.getElementById('groupBRate').addEventListener('input', updateDisplay);

        // Initial update
        updateDisplay();
    </script>
</body>
</html>
